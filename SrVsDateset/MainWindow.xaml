<Window x:Class="SrVsDataset.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SrVsDataset"
        xmlns:controls="clr-namespace:SrVsDataset.Controls"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
        mc:Ignorable="d"
        Title="차선 데이터셋 수집 시스템" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen">
    
    <Grid Background="#1E1E1E">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Padding="20">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#FFD700" Offset="0"/>
                    <GradientStop Color="#FFAA00" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Border.Effect>
                <DropShadowEffect ShadowDepth="3" Direction="270" Color="Black" Opacity="0.3" BlurRadius="6"/>
            </Border.Effect>
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="🚗" FontSize="28" Margin="0,0,15,0" VerticalAlignment="Center"/>
                <TextBlock Text="SMARTROAD 차선 데이터셋 수집 시스템" 
                           Foreground="#1E1E1E" FontSize="24" FontWeight="Bold" VerticalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- Main Content Area -->
        <Grid Grid.Row="1" Margin="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Camera Preview (Left - Large Area) -->
            <GroupBox Grid.Column="0" Header="카메라 프리뷰 (Ctrl+휠: 줌, 드래그: 이동)" Margin="0,0,20,0"
                      Style="{StaticResource ModernGroupBoxStyle}">
                <controls:ImageViewer ImageSource="{Binding CameraPreview}"/>
            </GroupBox>

            <!-- Control Panels (Right) -->
            <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="0,0,0,20">
                    <!-- Camera Connection Status -->
                    <GroupBox Header="카메라 연결" Style="{StaticResource ModernGroupBoxStyle}" Margin="0,0,0,10">
                        <StackPanel Margin="10">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Ellipse Width="15" Height="15" Margin="0,0,10,0">
                                    <Ellipse.Fill>
                                        <SolidColorBrush Color="{Binding IsCameraConnected, Converter={StaticResource BooleanToColorConverter}}"/>
                                    </Ellipse.Fill>
                                </Ellipse>
                                <TextBlock Text="{Binding IsCameraConnected, Converter={StaticResource BooleanToConnectionStatusConverter}}" 
                                           Foreground="White" VerticalAlignment="Center"/>
                            </StackPanel>
                            <Button Content="카메라 연결" 
                                    Command="{Binding InitializeCameraCommand}"
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Margin="0,0,0,5"/>
                            <Button Content="카메라 연결 해제" 
                                    Command="{Binding DisconnectCameraCommand}"
                                    Style="{StaticResource ModernButtonStyle}"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- GPS Status -->
                    <GroupBox Header="GPS 상태" Style="{StaticResource ModernGroupBoxStyle}" Margin="0,0,0,10">
                        <StackPanel Margin="10">
                            <Label Content="GPS 포트:" Foreground="White"/>
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <ComboBox Grid.Column="0" 
                                          ItemsSource="{Binding AvailableGpsPorts}" 
                                          SelectedItem="{Binding SelectedGpsPort}"
                                          Margin="0,0,5,0"/>
                                <Button Grid.Column="1" 
                                        Content="새로고침" 
                                        Command="{Binding RefreshGpsPortsCommand}"
                                        Style="{StaticResource ModernButtonStyle}"
                                        Padding="5,2"/>
                            </Grid>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Ellipse Width="15" Height="15" Margin="0,0,10,0">
                                    <Ellipse.Fill>
                                        <Binding Path="IsGpsConnected" 
                                                 Converter="{StaticResource BooleanToColorConverter}"/>
                                    </Ellipse.Fill>
                                </Ellipse>
                                <TextBlock Text="{Binding IsGpsConnected, 
                                                  Converter={StaticResource BooleanToConnectionStatusConverter}}"
                                           Foreground="White" VerticalAlignment="Center"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Content="GPS 연결" 
                                        Command="{Binding ConnectGpsCommand}"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Margin="0,0,5,0" Padding="10,5" FontWeight="Bold"/>
                                <Button Content="GPS 해제" 
                                        Command="{Binding DisconnectGpsCommand}"
                                        Style="{StaticResource ModernButtonStyle}"
                                        Padding="10,5"/>
                            </StackPanel>

                            <Label Content="현재 위치:" Foreground="White"
                                   Visibility="{Binding IsGpsConnected, 
                                               Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            <TextBlock Visibility="{Binding IsGpsConnected, 
                                                   Converter={StaticResource BooleanToVisibilityConverter}}"
                                       Foreground="#FFD700" FontFamily="Consolas" FontSize="14" FontWeight="Bold">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="위도: {0:F6}&#x0a;경도: {1:F6}">
                                        <Binding Path="CurrentGpsLocation.Latitude"/>
                                        <Binding Path="CurrentGpsLocation.Longitude"/>
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>

                            <Label Content="GPS 상태:" Foreground="White" Margin="0,5,0,0"/>
                            <TextBlock Text="{Binding GpsStatus}" 
                                       FontWeight="Bold" TextWrapping="Wrap" Foreground="#FFD700"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Sensor Status -->
                    <GroupBox Header="센서 상태" Style="{StaticResource ModernGroupBoxStyle}" Margin="0,0,0,10">
                        <StackPanel Margin="10">
                            <Label Content="센서 포트:" Foreground="White"/>
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <ComboBox Grid.Column="0" 
                                          ItemsSource="{Binding AvailableSensorPorts}" 
                                          SelectedItem="{Binding SelectedSensorPort}"
                                          Margin="0,0,5,0"/>
                                <Button Grid.Column="1" 
                                        Content="새로고침" 
                                        Command="{Binding RefreshSensorPortsCommand}"
                                        Style="{StaticResource ModernButtonStyle}"
                                        Padding="5,2"/>
                            </Grid>

                            <Label Content="Baudrate:" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding AvailableBaudrates}" 
                                      SelectedItem="{Binding SelectedBaudrate}"
                                      Margin="0,0,0,10"/>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Ellipse Width="15" Height="15" Margin="0,0,10,0">
                                    <Ellipse.Fill>
                                        <Binding Path="IsSensorConnected" 
                                                 Converter="{StaticResource BooleanToColorConverter}"/>
                                    </Ellipse.Fill>
                                </Ellipse>
                                <TextBlock Text="{Binding IsSensorConnected, 
                                                 Converter={StaticResource BooleanToConnectionStatusConverter}}" 
                                           Foreground="White" VerticalAlignment="Center"/>
                            </StackPanel>

                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Content="센서 연결" 
                                        Command="{Binding ConnectSensorCommand}"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Margin="0,0,2.5,0" Padding="10,5"/>
                                <Button Grid.Column="1" Content="센서 해제" 
                                        Command="{Binding DisconnectSensorCommand}"
                                        Style="{StaticResource ModernButtonStyle}"
                                        Margin="2.5,0,0,0" Padding="10,5"/>
                            </Grid>

                            <!-- Sensor Data Display -->
                            <StackPanel Visibility="{Binding IsSensorConnected, 
                                                    Converter={StaticResource BooleanToVisibilityConverter}}">
                                <Label Content="센서 데이터:" Foreground="White" FontWeight="Bold"/>
                                
                                <!-- Light Sensor -->
                                <Label Content="조도:" Foreground="White" Margin="0,5,0,0"/>
                                <Grid>
                                    <ProgressBar Value="{Binding LightLevel}" Maximum="100" Height="20" 
                                                 Foreground="#FFD700" Background="#333333"/>
                                    <TextBlock Text="{Binding LightLevel, StringFormat='{}{0:F1}%'}" 
                                               HorizontalAlignment="Center" VerticalAlignment="Center" 
                                               Foreground="Black" FontWeight="Bold"/>
                                </Grid>

                                <!-- Temperature & Humidity -->
                                <Grid Margin="0,10,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <Label Content="온도:" Foreground="White"/>
                                        <TextBlock Text="{Binding Temperature, StringFormat='{}{0:F1}°C'}" 
                                                   Foreground="#FFD700" FontWeight="Bold" FontSize="16"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <Label Content="습도:" Foreground="White"/>
                                        <TextBlock Text="{Binding Humidity, StringFormat='{}{0:F1}%'}" 
                                                   Foreground="#FFD700" FontWeight="Bold" FontSize="16"/>
                                    </StackPanel>
                                </Grid>

                                <!-- IMU Data (Collapsible) -->
                                <Expander Header="IMU 데이터" Margin="0,10,0,0" 
                                          Foreground="White" Background="#2D2D30">
                                    <StackPanel Margin="5">
                                        <TextBlock Foreground="White" FontFamily="Consolas" FontSize="12">
                                            <TextBlock.Text>
                                                <MultiBinding StringFormat="가속도: X={0:F2}, Y={1:F2}, Z={2:F2}">
                                                    <Binding Path="AccelX"/>
                                                    <Binding Path="AccelY"/>
                                                    <Binding Path="AccelZ"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                        <TextBlock Foreground="White" FontFamily="Consolas" FontSize="12" Margin="0,2,0,0">
                                            <TextBlock.Text>
                                                <MultiBinding StringFormat="자이로: X={0:F2}, Y={1:F2}, Z={2:F2}">
                                                    <Binding Path="GyroX"/>
                                                    <Binding Path="GyroY"/>
                                                    <Binding Path="GyroZ"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                        <TextBlock Foreground="White" FontFamily="Consolas" FontSize="12" Margin="0,2,0,0">
                                            <TextBlock.Text>
                                                <MultiBinding StringFormat="자력계: X={0:F2}, Y={1:F2}, Z={2:F2}">
                                                    <Binding Path="MagX"/>
                                                    <Binding Path="MagY"/>
                                                    <Binding Path="MagZ"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                        <TextBlock Foreground="White" FontFamily="Consolas" FontSize="12" Margin="0,2,0,0">
                                            <TextBlock.Text>
                                                <MultiBinding StringFormat="자세: Roll={0:F2}, Pitch={1:F2}, Yaw={2:F2}">
                                                    <Binding Path="Roll"/>
                                                    <Binding Path="Pitch"/>
                                                    <Binding Path="Yaw"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                    </StackPanel>
                                </Expander>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <!-- Recording Control -->
                    <GroupBox Header="녹화 제어" Style="{StaticResource ModernGroupBoxStyle}" Margin="0,0,0,10">
                        <StackPanel Margin="10">
                            <Label Content="비디오 압축:" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding VideoCompressionTypes}" 
                                      SelectedItem="{Binding SelectedVideoCompression}"
                                      Margin="0,0,0,10"/>

                            <Button Content="스냅샷" 
                                    Command="{Binding TakeSnapshotCommand}"
                                    Style="{StaticResource ModernButtonStyle}"
                                    Margin="0,0,0,10"/>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Content="녹화 시작" 
                                        Command="{Binding StartRecordingCommand}"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Margin="0,0,5,0" Padding="10,8" FontSize="14" FontWeight="Bold"/>

                                <Button Content="녹화 종료" 
                                        Command="{Binding StopRecordingCommand}"
                                        Style="{StaticResource ModernButtonStyle}"
                                        Padding="10,8" FontSize="14" FontWeight="Bold"/>
                            </StackPanel>

                            <TextBlock Text="녹화 시간:" Margin="0,5,0,0" Foreground="White"/>
                            <TextBlock Text="{Binding RecordingDuration, StringFormat='{}{0:hh\\:mm\\:ss}'}" 
                                       FontSize="18" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#FFD700"/>

                            <TextBlock Text="상태:" Margin="0,5,0,0" Foreground="White"/>
                            <TextBlock Text="{Binding RecordingStatus}" 
                                       FontWeight="Bold" TextWrapping="Wrap" Foreground="#FFD700"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Recording Mode Settings -->
                    <GroupBox Header="녹화 모드 설정" Style="{StaticResource ModernGroupBoxStyle}" Margin="0,0,0,10">
                        <StackPanel Margin="10">
                            <Label Content="녹화 모드:" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding RecordingModes}" 
                                      SelectedItem="{Binding SelectedRecordingMode}"
                                      Margin="0,0,0,10">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Converter={StaticResource RecordingModeDisplayConverter}}"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            
                            <TextBlock Text="• 연속 모드: 각 센서 독립 동작 (기존 방식)" 
                                       Foreground="Gray" FontSize="11" Margin="0,0,0,2"/>
                            <TextBlock Text="• 동기화 모드: 30Hz 정밀 동기화" 
                                       Foreground="Gray" FontSize="11" Margin="0,0,0,10"/>
                                       
                            <TextBlock Text="동기화 상태:" 
                                       Foreground="White" 
                                       Visibility="{Binding IsSynchronizedMode, Converter={StaticResource BooleanToVisibilityConverter}}"
                                       Margin="0,0,0,5"/>
                            <StackPanel Orientation="Horizontal" 
                                        Visibility="{Binding IsSynchronizedMode, Converter={StaticResource BooleanToVisibilityConverter}}"
                                        Margin="0,0,0,10">
                                <Ellipse Width="12" Height="12" Margin="0,0,8,0">
                                    <Ellipse.Fill>
                                        <SolidColorBrush Color="{Binding IsSyncActive, Converter={StaticResource BooleanToColorConverter}}"/>
                                    </Ellipse.Fill>
                                </Ellipse>
                                <TextBlock Text="{Binding SyncStatus}" 
                                           Foreground="White" FontSize="11" VerticalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <!-- Environment Settings -->
                    <GroupBox Header="환경 설정" Style="{StaticResource ModernGroupBoxStyle}" Margin="0,0,0,10">
                        <StackPanel Margin="10">
                            <Label Content="도로 종류:" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding RoadTypes}" 
                                      SelectedItem="{Binding SelectedRoadType}"
                                      Margin="0,0,0,10"/>

                            <Label Content="날씨:" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding WeatherTypes}" 
                                      SelectedItem="{Binding SelectedWeather}"
                                      Margin="0,0,0,10"/>

                            <Label Content="시간대:" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding TimeOfDayTypes}" 
                                      SelectedItem="{Binding SelectedTimeOfDay}"
                                      Margin="0,0,0,10"/>

                            <Label Content="녹화 위치:" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding RecordingSides}" 
                                      SelectedItem="{Binding SelectedRecordingSide}"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Camera Settings -->
                    <GroupBox Header="카메라 설정" Style="{StaticResource ModernGroupBoxStyle}">
                        <StackPanel Margin="10">
                            <Label Content="노출 모드:" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding ExposureModes}" 
                                      SelectedItem="{Binding SelectedExposureMode}"
                                      Margin="0,0,0,10"/>

                            <Label Content="노출 시간 (μs):" Foreground="White"
                                   Visibility="{Binding IsExposureManual, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            <Grid Visibility="{Binding IsExposureManual, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="60"/>
                                </Grid.ColumnDefinitions>
                                <Slider Grid.Column="0" 
                                        Minimum="1" Maximum="100000" 
                                        Value="{Binding ExposureTime}"
                                        TickFrequency="10000" IsSnapToTickEnabled="True"/>
                                <TextBox Grid.Column="1" 
                                         Text="{Binding ExposureTime}" 
                                         Margin="5,0,0,0"/>
                            </Grid>

                            <Label Content="화이트 밸런스:" Margin="0,10,0,0" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding WhiteBalanceModes}" 
                                      SelectedItem="{Binding SelectedWhiteBalanceMode}"
                                      Margin="0,0,0,10"/>

                            <Label Content="색온도 (K):" Foreground="White"
                                   Visibility="{Binding IsWhiteBalanceManual, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            <Grid Visibility="{Binding IsWhiteBalanceManual, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="60"/>
                                </Grid.ColumnDefinitions>
                                <Slider Grid.Column="0" 
                                        Minimum="2800" Maximum="8000" 
                                        Value="{Binding WhiteBalanceTemperature}"/>
                                <TextBox Grid.Column="1" 
                                         Text="{Binding WhiteBalanceTemperature}" 
                                         Margin="5,0,0,0"/>
                            </Grid>

                            <Button Content="One Push WB" 
                                    Command="{Binding OnePushWhiteBalanceCommand}"
                                    Style="{StaticResource ModernButtonStyle}"
                                    Background="#4CAF50" BorderBrush="#4CAF50"
                                    Margin="0,10,0,0" Padding="10,5" FontWeight="Bold"
                                    Visibility="{Binding IsWhiteBalanceManual, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="Daylight" 
                                        Command="{Binding SetWhiteBalancePresetCommand}"
                                        CommandParameter="Daylight"
                                        Style="{StaticResource ModernButtonStyle}"
                                        Margin="0,0,5,0" Padding="5,2"/>
                                <Button Content="Cloudy" 
                                        Command="{Binding SetWhiteBalancePresetCommand}"
                                        CommandParameter="Cloudy"
                                        Style="{StaticResource ModernButtonStyle}"
                                        Margin="0,0,5,0" Padding="5,2"/>
                                <Button Content="Tungsten" 
                                        Command="{Binding SetWhiteBalancePresetCommand}"
                                        CommandParameter="Tungsten"
                                        Style="{StaticResource ModernButtonStyle}"
                                        Padding="5,2"/>
                            </StackPanel>

                            <Label Content="이미지 회전:" Margin="0,15,0,0" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding ImageRotations}" 
                                      SelectedItem="{Binding SelectedImageRotation}"
                                      Margin="0,0,0,10"/>

                            <Label Content="이미지 플립:" Foreground="White"/>
                            <ComboBox ItemsSource="{Binding ImageFlips}" 
                                      SelectedItem="{Binding SelectedImageFlip}"
                                      Margin="0,0,0,10"/>

                            <Button Content="설정 적용" 
                                    Command="{Binding ApplyCameraSettingsCommand}"
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Margin="0,15,0,0" Padding="10,5" FontWeight="Bold"/>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2" Background="#333333" Foreground="White">
            <StatusBarItem>
                <TextBlock Text="해상도: " Foreground="White"/>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="{Binding CurrentResolution}" Foreground="#FFD700"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Text="FPS: " Foreground="White"/>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="{Binding CurrentFps, StringFormat='{}{0:F1}'}" Foreground="#FFD700"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Text="카메라 온도: " Foreground="White"/>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="{Binding CameraTemperature, StringFormat='{}{0:F1}°C'}" Foreground="#FFD700"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Text="GPS: " Foreground="White"/>
            </StatusBarItem>
            <StatusBarItem>
                <Ellipse Width="10" Height="10" Margin="0,0,5,0">
                    <Ellipse.Fill>
                        <Binding Path="IsGpsConnected" 
                                 Converter="{StaticResource BooleanToColorConverter}"/>
                    </Ellipse.Fill>
                </Ellipse>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="{Binding IsGpsConnected, 
                                  Converter={StaticResource BooleanToConnectionStatusConverter}}"
                           Foreground="#FFD700"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Text="저장 경로: " Foreground="White"/>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="{Binding SavePath}" Foreground="#FFD700"/>
            </StatusBarItem>
            <StatusBarItem>
                <Button Content="변경" 
                        Command="{Binding ChangeSavePathCommand}"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Padding="5,0" Margin="5,0,0,0" Height="20"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
