# **차선 자동 재도색을 위한 데이터셋 구축 최종 계획서**

본 문서는 차선 재도색 AI 모델 개발에 필요한 데이터셋을 체계적으로 구축하기 위한 전체 계획을 정의합니다. 이 계획은 추후 데이터베이스(DB) 시스템 개발의 밑거름이 될 것을 목표로 합니다.

### **1단계: 데이터의 청사진 \- 폴더 구조 설계**

모든 작업에 앞서, 수집될 원본 영상과 메타데이터를 저장할 폴더 구조(청사진)를 미리 정의합니다. 이 구조는 데이터의 거시적인 환경을 정의하며, 데이터의 일관성을 보장하고 추후 데이터베이스를 구축하기 위한 핵심적인 기본 구성이 됩니다.

#### **기본 폴더 구조**

LANE\_REPAINT\_DATASET/  
├── highway/  
│   ├── clear/  
│   │   ├── am/  
│   │   │   ├── left/  
│   │   │   └── right/  
│   │   ├── midday/  
│   │   │   ├── left/  
│   │   │   └── right/  
│   │   ├── pm/  
│   │   │   ├── left/  
│   │   │   └── right/  
│   │   └── night/  
│   │       ├── left/  
│   │       └── right/  
│   └── cloudy/  
│       ├── am/  
│       │   ├── left/  
│       │   └── right/  
│       └── ... (이하 동일 구조)  
│  
└── urban/  
    ├── clear/  
    │   ├── am/  
    │   │   ├── left/  
    │   │   └── right/  
    │   └── ... (이하 동일 구조)  
    └── cloudy/  
        └── ... (이하 동일 구조)

### **2단계: 스마트한 데이터 수집**

전용 데이터 수집 인터페이스를 사용하여, 작업자의 판단을 최소화하고 객관적인 사실(Fact)만을 효율적으로 기록합니다.

#### **2.1. 사전 설정**

주행 시작 전, 인터페이스에서 다음의 환경 조건을 콤보 박스를 통해 한 번만 설정합니다.

* **도로 종류 (Road Type)**: highway, urban  
* **날씨 (Weather)**: clear, cloudy  
* **시간대 (Time of Day)**: am (07-10시), midday (10-14시), pm (14-18시), night (18-23시)  
* **녹화 위치 (Recording Side)**: left, right

#### **2.1.1. 카메라 설정**

주행 시작 전, 카메라의 이미지 품질 관련 설정을 조정할 수 있습니다. 이는 다양한 조명 환경에서 일관된 품질의 영상을 확보하기 위함입니다.

* **노출 시간 (Exposure Time)**: 1 ~ 100,000 마이크로초 (μs) 범위에서 수동 설정
  * 주간: 1,000 ~ 5,000 μs 권장
  * 야간: 10,000 ~ 50,000 μs 권장
* **화이트 밸런스 (White Balance)**: 
  * 모드: Auto(자동) / Manual(수동)
  * 색온도: 2,800K ~ 8,000K (수동 모드 시)
  * 프리셋: Daylight(5,600K), Cloudy(6,500K), Tungsten(3,200K)

#### **2.2. 녹화 및 자동 메타데이터 수집**

직관적인 \[시작\]/\[종료\] 버튼으로 녹화를 제어합니다. 녹화가 진행되는 동안 시스템은 다음 정보를 자동으로 수집합니다.

* **타임스탬프**: 날짜, 녹화 시작 시간, 녹화 종료 시간  
* **환경 설정**: 도로 종류, 날씨, 시간대, 녹화 위치
* **카메라 설정**: 노출 시간, 화이트 밸런스 모드 및 색온도
* **하드웨어 정보**: 카메라 온도 (녹화 종료 시점), GPS 좌표 (시작 및 종료 시점)

#### **2.3. 자동 저장**

녹화 종료 시, 1단계에서 설계된 폴더 경로에 아래의 규칙에 따라 \*\*영상 파일(.mp4)\*\*과 \*\*메타데이터 파일(.json)\*\*이 한 쌍으로 자동 저장됩니다.

* **파일명 규칙**: YYYYMMDD\_HHMMSS(시작)\_HHMMSS(종료)\_\[녹화위치\]  
  * **영상 예시**: 20250729\_112000\_113515\_left.mp4  
  * **JSON 예시**: 20250729\_112000\_113515\_left.json  
* **메타데이터 형식**: 계층적 정보를 표현하는 데 용이한 **JSON** 형식을 사용합니다. 이를 통해 GPS 좌표, 타임스탬프, 하드웨어 정보, 카메라 설정 등을 구조적으로 명확하게 저장할 수 있습니다.

**JSON 메타데이터 예시**:
```json
{
  "timestamp": {
    "date": "2025-07-29",
    "start_time": "11:20:00",
    "end_time": "11:35:15"
  },
  "environment": {
    "road_type": "highway",
    "weather": "clear",
    "time_of_day": "midday",
    "recording_side": "left"
  },
  "camera_settings": {
    "exposure_time": 5000,
    "white_balance_mode": "manual",
    "white_balance_temperature": 5600
  },
  "hardware": {
    "camera_temperature": 45.2,
    "gps": {
      "start": {
        "latitude": 37.5665,
        "longitude": 126.9780,
        "timestamp": "2025-07-29T11:20:00"
      },
      "end": {
        "latitude": 37.5123,
        "longitude": 126.9456,
        "timestamp": "2025-07-29T11:35:15"
      }
    }
  }
}
```

* **GPS 처리**: NK-GPS-U 장비의 NMEA 0183 프로토콜 파싱을 지원하며, 장비 미연결 또는 신호 불량 시 관련 값은 null로 기록됩니다.

### **3단계: 데이터의 보관 \- 계층적 저장**

데이터의 역할과 사용 빈도에 따라 저장소를 이원화하여 비용 효율성과 데이터 처리 속도를 모두 확보합니다.

| 구분 (Category) | 데이터 (Data) | 저장소 (Storage) | 목적 (Purpose) |
| :---- | :---- | :---- | :---- |
| **Cold Storage**\<br\>(영구 보관) | 원본 영상(.mp4) 및\<br\>메타데이터(.json) | 저렴한 대용량 스토리지\<br\>(HDD, NAS, 클라우드 아카이브) | **데이터의 원천 보존**,\<br\>미래의 재활용 및 복구 |
| **Hot Storage**\<br\>(실시간 사용) | 추출된 이미지(.png) 및\<br\>라벨 마스크(.png) | 빠르고 비싼 스토리지\<br\>(NVMe SSD) | **신속한 모델 학습**\<br\>(빠른 I/O 속도 보장) |

**▶ 원칙: Cold Storage에 보관된 원본 영상과 메타데이터는 절대 수정하거나 삭제하지 않는다.**

### **4.단계: 최종 결과물 \- 학습용 데이터셋 구성**

실제 AI 모델 학습에 사용될 최종 데이터셋은 다음과 같은 표준 구조를 따릅니다.

#### **4.1. 추출 및 라벨링**

Cold Storage의 원본 영상과 메타데이터를 기반으로, 학습에 필요한 프레임만 이미지(.png)로 추출합니다. 이후 라벨링 툴(CVAT 등)을 사용해 차선 영역을 정교하게 색칠한 마스크 이미지를 제작합니다.

#### **4.2. 1:1 매칭 구조**

이미지와 라벨(마스크)을 train, validation, test 세트로 분할하여 1:1로 매칭되는 폴더 구조를 완성합니다.

final\_dataset/  
├── train/  
│   ├── images/  
│   │   └── 00001.png  
│   └── labels/  
│       └── 00001.png  
├── validation/  
│   ├── images/  
│   │   └── 00002.png  
│   └── labels/  
│       └── 00002.png  
└── test/  
    ...

#### **4.3. 설정 파일**

dataset.yaml 파일을 통해 데이터셋의 경로, 클래스 이름, 클래스 수 등의 정보를 정의하여, 어떤 학습 환경에서도 동일한 조건으로 데이터셋을 불러올 수 있도록 합니다. 이는 학습 파이프라인의 재현성과 이식성을 보장하는 시작점 역할을 합니다.